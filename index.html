<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shoulder Rehab Protocol</title>
    <style>
        /* CSS Reset and Base Styles (Mimicking Tailwind) */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f9fafb; color: #1f2937; padding: 1rem; line-height: 1.5; }
        
        /* Layout Containers */
        .container { max-width: 56rem; margin: 0 auto; background: white; border-radius: 0.75rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); overflow: hidden; border: 1px solid #e5e7eb; }
        .p-6 { padding: 1.5rem; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-4 { gap: 1rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mt-2 { margin-top: 0.5rem; }
        
        /* Typography */
        h1 { font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem; }
        h2 { font-size: 1.125rem; font-weight: 700; color: #1e3a8a; }
        h3 { font-size: 1.125rem; font-weight: 700; color: #111827; display: flex; align-items: center; margin-bottom: 1rem; }
        .text-sm { font-size: 0.875rem; }
        .font-mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }
        .text-gray-500 { color: #6b7280; }
        
        /* Header */
        .header { background-color: #facc15; color: #111827; }
        
        /* Input Section */
        .input-section { background-color: #f9fafb; border-bottom: 1px solid #e5e7eb; }
        .input-group { display: flex; gap: 1rem; align-items: flex-end; flex-wrap: wrap; }
        .input-wrapper { width: 100%; max-width: 20rem; }
        label { display: block; font-size: 0.875rem; font-weight: 600; color: #374151; margin-bottom: 0.5rem; }
        input[type="text"] { width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-size: 0.875rem; }
        input[type="text"]:focus { outline: none; border-color: #2563eb; box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2); }
        
        button.primary-btn { background-color: #2563eb; color: white; font-weight: 600; padding: 0.75rem 1.5rem; border: none; border-radius: 0.375rem; cursor: pointer; transition: background-color 0.2s; }
        button.primary-btn:hover { background-color: #1d4ed8; }
        
        /* Status Bar */
        .status-bar { background-color: #eff6ff; border-bottom: 1px solid #e5e7eb; }
        .status-pill { background-color: white; padding: 0.25rem 0.75rem; border-radius: 0.25rem; border: 1px solid #e5e7eb; font-size: 0.875rem; color: #6b7280; }
        .future-pill { display: inline-block; background-color: #fef9c3; color: #854d0e; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600; margin-top: 0.5rem; }
        
        /* Lists */
        ul { list-style: none; }
        li { display: flex; align-items: flex-start; margin-bottom: 0.5rem; }
        .dot { width: 0.375rem; height: 0.375rem; border-radius: 50%; margin-top: 0.5rem; margin-right: 0.75rem; flex-shrink: 0; }
        .bg-green { background-color: #22c55e; }
        .bg-red { background-color: #ef4444; }
        .bg-purple { background-color: #a855f7; }
        .bg-blue { background-color: #3b82f6; }
        
        /* Sections */
        .bg-red-50 { background-color: #fef2f2; }
        .text-red-900 { color: #7f1d1d; }
        .text-red-800 { color: #991b1b; }
        .bg-gray-50 { background-color: #f9fafb; }
        .grid-2 { display: grid; grid-template-columns: 1fr; gap: 0.5rem 1.5rem; }
        
        /* Icons */
        .icon { width: 1.25rem; height: 1.25rem; margin-right: 0.5rem; }
        
        /* Text Area */
        .copy-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
        .copy-btn { display: inline-flex; align-items: center; padding: 0.375rem 0.75rem; border: 1px solid #d1d5db; background: white; border-radius: 0.375rem; font-size: 0.75rem; font-weight: 500; color: #374151; cursor: pointer; }
        .copy-btn:hover { background-color: #f9fafb; }
        textarea { width: 100%; height: 12rem; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: #f9fafb; color: #4b5563; font-family: monospace; font-size: 0.875rem; resize: vertical; }
        
        /* Utilities */
        .hidden { display: none; }
        .border-t { border-top: 1px solid #e5e7eb; }
        .text-center { text-align: center; }
        
        @media (min-width: 768px) {
            .grid-2 { grid-template-columns: 1fr 1fr; }
            .flex-row-md { flex-direction: row; }
            h1 { font-size: 1.875rem; }
        }
    </style>
</head>
<body>

<div class="container">
    <!-- Header -->
    <div class="header p-6">
        <h1>PWH Physio Standard Rotator Cuff Repair rehab protocol</h1>
        <p>Enter the operation date to generate specific goals, interventions, and precautions based on the post-op timeline.</p>
    </div>

    <!-- Input -->
    <div class="input-section p-6">
        <div class="input-group">
            <div class="input-wrapper">
                <label for="dateInput">Operation Date (DD/MM/YYYY)</label>
                <input type="text" id="dateInput" placeholder="DD/MM/YYYY" maxlength="10">
            </div>
            <button id="enterBtn" class="primary-btn">Enter</button>
        </div>
    </div>

    <!-- Results Container -->
    <div id="resultsContainer" class="hidden">
        <!-- Status Bar -->
        <div class="status-bar p-6 flex flex-col flex-row-md justify-between items-center gap-4">
            <div>
                <h2 id="phaseName">Phase Name</h2>
                <div class="mt-2" style="color: #1d4ed8; font-weight: 500;">
                    <span id="daysPostOp">0</span> Days Post-Op 
                    <span style="color: #3b82f6; margin: 0 0.5rem;">|</span> 
                    Week <span id="weeksPostOp">0</span> + <span id="remainderDays">0</span> Days
                </div>
                <span id="futureLabel" class="future-pill hidden">Future Date Selected</span>
            </div>
            <div class="status-pill" id="dayRange">Day Range: 0 - 0</div>
        </div>

        <!-- Goals -->
        <div class="p-6">
            <h3>
                <!-- CheckCircle Icon -->
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/></svg>
                Goals
            </h3>
            <ul id="goalsList"></ul>
        </div>

        <!-- Precautions -->
        <div class="p-6 bg-red-50">
            <h3 class="text-red-900">
                <!-- ShieldAlert Icon -->
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="M12 8v4"/><path d="M12 16h.01"/></svg>
                Precautions & ROM Limits
            </h3>
            <ul id="precautionsList"></ul>
        </div>

        <!-- Assessments -->
        <div class="p-6">
            <h3>
                <!-- Activity Icon -->
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#9333ea" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                Outcome Measures / Assessment
            </h3>
            <p class="text-sm text-gray-500 mb-4" style="text-transform: uppercase; font-weight: 600; letter-spacing: 0.05em;">Tests/Checks required this timeframe:</p>
            <ul id="assessmentsList"></ul>
        </div>

        <!-- Interventions -->
        <div class="p-6 bg-gray-50">
            <h3>
                <!-- FileText Icon -->
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/></svg>
                Interventions
            </h3>
            <ul id="interventionsList" class="grid-2"></ul>
        </div>

        <!-- Text Area -->
        <div class="p-6 border-t">
            <div class="copy-header">
                <h3 style="margin:0; font-size: 0.875rem; color: #6b7280; text-transform: uppercase;">Generated Treatment Record Text</h3>
                <button id="copyBtn" class="copy-btn">
                    <!-- Clipboard Icon -->
                    <svg id="copyIcon" class="icon" style="width:16px; height:16px; color:#6b7280;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/></svg>
                    <span id="copyText">Copy to Clipboard</span>
                </button>
            </div>
            <textarea id="generatedText" readonly></textarea>
        </div>
    </div>

    <!-- Empty State -->
    <div id="emptyState" class="p-6 text-center text-gray-500" style="padding: 3rem;">
        Please select an operation date (DD/MM/YYYY) and click Enter to begin.
    </div>

    <!-- Out of Range State -->
    <div id="outOfRangeState" class="hidden p-6 text-center text-gray-500" style="padding: 3rem;">
        The calculated date falls outside the standard protocol range (0 days to 1 year).
    </div>
</div>

<script>
// --- Data ---
const PROTOCOL_DATA = [
  {
    phaseName: "Post-op 0-1 Week",
    startDay: 0,
    endDay: 13,
    goals: [
      "Maintain repair integrity",
      "Minimize pain and inflammation",
      "Normalize scapula position and mobility",
      "Initial staged PROM exercises (<15% supraspinatus EMG activity)",
      "Aim PROM F/Abd 60-90°, ER 0-20° at 20° Abd, IR to belly by 2 weeks"
    ],
    precautions: [
      "Avoid shoulder AROM exercise",
      "Avoid excessive stretching or sudden movements",
      "Avoid lifting/supporting of body weight by hands",
      "ADL: Avoid cloth donning with the affected limb",
      "Avoid clothing with small buttons, hooks or zips",
      "Ladies may prefer to wear a front fastening bra"
    ],
    assessments: [
      "Check wound healing",
      "Pain levels (VAS)",
      "Sling fit and position"
    ],
    interventions: [
      "Arm sling in neutral position",
      "Pendulum exercise",
      "PROM F/Abd < 90°, ER < 20° at 20° Abd",
      "Self forward bow",
      "Self-assisted passive F with opposite hand",
      "Bar-assisted ER in supine/upright position",
      "Therapist assisted F in seated/side lying/supine",
      "Active scapula retraction & depression in side-lying",
      "Active neck mobilization exercise",
      "Elbow/wrist/finger mobilizing exercise",
      "PROM for elbow only if bicep Tenodesis performed (allow AROM at 6 weeks)",
      "Cryotherapy and electrotherapy for swelling control",
      "Manual soft-tissue techniques"
    ]
  },
  {
    phaseName: "Post-op 2 Weeks",
    startDay: 14,
    endDay: 20,
    goals: [
      "Progress staged PROM exercises (<15% supraspinatus EMG activity)",
      "Aim PROM F 90-120°, ER 20-30° at 20° Abd by 6 weeks"
    ],
    precautions: [
      "Continue previous precautions",
      "Sling use continues"
    ],
    assessments: [
      "PROM measurements",
      "Scapular mobility check"
    ],
    interventions: [
      "PROM F < 120°, ER < 30° at 20° Abd",
      "Grade I & II shoulder girdle joints gliding (GH, SC, AC, ST)",
      "Continue previous appropriate exercises"
    ]
  },
  {
    phaseName: "Post-op 3-5 Weeks",
    startDay: 21,
    endDay: 41,
    goals: [
      "Initial AAROM exercises (<15% supraspinatus EMG activity)",
      "Aim AAROM F/Abd 60-90°, ER 0-20° at 20° of Abd by 6 weeks"
    ],
    precautions: [
      "Delay elbow strengthening till 6 weeks if bicep tenodesis performed"
    ],
    assessments: [
      "Criteria to advance to Phase 2 (6 weeks): PROM F 90-120°, ER 20-30° at 20° Abd"
    ],
    interventions: [
      "AAROM F/Abd < 90°, ER < 30°",
      "Supine press up",
      "Supine active assisted ER",
      "Supine active assisted Abd",
      "Side-lying assisted active F",
      "Elbow/wrist/fingers light strengthening"
    ]
  },
  {
    phaseName: "Post-op 6-9 Weeks",
    startDay: 42,
    endDay: 69,
    goals: [
      "Regain full A/PROM in all direction (< 20% supraspinatus EMG activity)",
      "Restore stability, strength and scapular neuromuscular control",
      "Initiate light, non-repetitive muscle activities/ADL below chest level"
    ],
    precautions: [
      "Avoid active over-head lifting/ ADL",
      "Avoid sudden jerking movements",
      "Avoid supporting of body weight by hands",
      "Avoid cloth donning with the affected limb till 8 weeks"
    ],
    assessments: [
      "ROM Assessment (A/PROM)",
      "Scapular control assessment"
    ],
    interventions: [
      "Full A/PROM as pain tolerated",
      "Inclined/seated press up",
      "Seated ER at 90° of Abd",
      "Towel slides at sagittal/ medial/ scapular plane",
      "Wall slides/ wall walks",
      "Ball roll",
      "Pulley",
      "Grade III & IV shoulder girdle joints gliding (GH, SC,AC, ST)",
      "Proprioception exercises",
      "Scapula and core strengthening",
      "Muscle re-education with ES in symmetrical pattern",
      "Light isometric/ isotonic ex (ER/IR/Ext)",
      "Light isotonic ex for shoulder ER in side lying (low-weight/high-rep)"
    ]
  },
  {
    phaseName: "Post-op 10-11 Weeks",
    startDay: 70,
    endDay: 83,
    goals: [
      "Regain full A/PROM in all direction",
      "Restore stability, strength and scapular neuromuscular control",
      "Initiate light, non-repetitive muscle activities/ADL below chest level"
    ],
    precautions: [
      "Avoid active over-head lifting/ ADL",
      "Avoid sudden jerking movements",
      "Avoid supporting of body weight by hands"
    ],
    assessments: [
      "Criteria to advance to Phase 3 (12 weeks): PROM FF >140°, ER > 30° at 20° Abd, ER > 75° at 90° Abd",
      "AROM FF >120°",
      "Satisfactory posture/ scapular control"
    ],
    interventions: [
      "Continue Full A/PROM as pain tolerated",
      "Continue strengthening exercises from previous phase",
      "Grade III & IV shoulder girdle joints gliding",
      "Proprioception exercises",
      "Scapula and core strengthening",
      "Muscle re-education"
    ]
  },
  {
    phaseName: "Post-op 12-19 Weeks",
    startDay: 84,
    endDay: 149,
    goals: [
      "Optimize neuromuscular control",
      "Gradually restore strength, power and endurance",
      "Return to ADL/ work/ recreational activities that do not require heavy lifting"
    ],
    precautions: [
      "Avoid lifting of objects heavier than 15-20lbs",
      "Avoid sudden lifting, jerking or pushing activities",
      "Avoid uncontrolled movements"
    ],
    assessments: [
      "Criteria to advance to Phase 4 (5 months): MMT > 4+/5",
      "Completed basic ADL and phase 3 strengthening with satisfactory dynamic stability",
      "Surgeon approval"
    ],
    interventions: [
      "Capsular stretching (corner, towel, cross-body, sleeper stretch)",
      "Aggressive strengthening",
      "Thera band x F/ER/IR/ throwing accelerate ex",
      "High, middle and low scapular rows",
      "OB pulley",
      "PNF pattern",
      "Body-blade ex",
      "Locked elbow extension for trapezius",
      "Press-up ex with dumbbell for serratus"
    ]
  },
  {
    phaseName: "Post-op 5-6 Months+",
    startDay: 150,
    endDay: 365,
    goals: [
      "Normalize muscular strength, power and endurance",
      "Returning to demanding functional activities",
      "Complete return to sports training"
    ],
    precautions: [
      "Avoid exercises that provide a large increase in load compared to previous exercises",
      "Avoid exercises significantly more stressful/ demanding than functional needs"
    ],
    assessments: [
      "Termination Assessment (5-8 months): Surgeon clearance (UCLA/Constant-Murley score)",
      "Symmetrical scapula-thoracic mobility and strength",
      "Complete functional progression with minimal pain",
      "Return to Sport: Initiate interval sport program after successful 3-6 weeks of plyometric program"
    ],
    interventions: [
      "Advance strengthening (Gradual increase weight over 6-12 weeks)",
      "Multi push and lift machine",
      "Foreword punch",
      "Dynamic hugs with OB pulley",
      "Prone ER x 90°",
      "Prone horizontal ABD x 90°",
      "Push-up/ push-up plus",
      "BTE Isokinetic training at 90/90°",
      "Activity specific training and technique modification",
      "Thrower ten Program",
      "Plyometric program"
    ]
  }
];

// --- Logic ---
const dateInput = document.getElementById('dateInput');
const enterBtn = document.getElementById('enterBtn');
const resultsContainer = document.getElementById('resultsContainer');
const emptyState = document.getElementById('emptyState');
const outOfRangeState = document.getElementById('outOfRangeState');

// Auto-format Date Input
dateInput.addEventListener('input', (e) => {
    let val = e.target.value;
    const numbers = val.replace(/[^\d]/g, '');
    let formatted = numbers;
    
    if (numbers.length >= 3 && numbers.length <= 4) {
        formatted = `${numbers.slice(0, 2)}/${numbers.slice(2)}`;
    } else if (numbers.length >= 5) {
        formatted = `${numbers.slice(0, 2)}/${numbers.slice(2, 4)}/${numbers.slice(4, 8)}`;
    }
    
    // Prevent double update if value didn't change
    if (dateInput.value !== formatted) {
        dateInput.value = formatted;
    }
});

// Helper to create list items
function createListItems(items, colorClass) {
    return items.map(item => `
        <li>
            <span class="dot ${colorClass}"></span>
            <span class="${colorClass === 'bg-red' ? 'text-red-800' : 'text-gray-700'}">${item}</span>
        </li>
    `).join('');
}

// Main Calculation Logic
function calculateProtocol() {
    const inputVal = dateInput.value;
    if (inputVal.length !== 10) return;

    const parts = inputVal.split('/');
    const day = parseInt(parts[0], 10);
    const month = parseInt(parts[1], 10) - 1;
    const year = parseInt(parts[2], 10);
    
    const opDate = new Date(year, month, day);
    if (isNaN(opDate.getTime())) return;

    const currentDate = new Date();
    // Reset time portion for accurate day calculation
    currentDate.setHours(0,0,0,0);
    opDate.setHours(0,0,0,0);

    const diffTime = Math.abs(currentDate - opDate);
    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
    const isFuture = opDate > currentDate;
    const displayDays = isFuture ? 0 : diffDays;
    
    const weeks = Math.floor(displayDays / 7);
    const remainderDays = displayDays % 7;

    const activePhase = PROTOCOL_DATA.find(p => displayDays >= p.startDay && displayDays <= p.endDay) 
                        || (displayDays > 365 ? PROTOCOL_DATA[PROTOCOL_DATA.length - 1] : null);

    // Update UI
    emptyState.classList.add('hidden');
    
    if (!activePhase) {
        resultsContainer.classList.add('hidden');
        outOfRangeState.classList.remove('hidden');
        return;
    }

    outOfRangeState.classList.add('hidden');
    resultsContainer.classList.remove('hidden');

    // Update Status Bar
    document.getElementById('phaseName').textContent = activePhase.phaseName;
    document.getElementById('daysPostOp').textContent = displayDays;
    document.getElementById('weeksPostOp').textContent = weeks;
    document.getElementById('remainderDays').textContent = remainderDays;
    document.getElementById('dayRange').textContent = `Day Range: ${activePhase.startDay} - ${activePhase.endDay}`;
    
    const futureLabel = document.getElementById('futureLabel');
    if (isFuture) futureLabel.classList.remove('hidden');
    else futureLabel.classList.add('hidden');

    // Update Lists
    document.getElementById('goalsList').innerHTML = createListItems(activePhase.goals, 'bg-green');
    document.getElementById('precautionsList').innerHTML = createListItems(activePhase.precautions, 'bg-red');
    document.getElementById('assessmentsList').innerHTML = createListItems(activePhase.assessments, 'bg-purple');
    document.getElementById('interventionsList').innerHTML = createListItems(activePhase.interventions, 'bg-blue');

    // Generate Text
    const generatedText = `PWH Physio Standard Rotator Cuff Repair rehab protocol
Date: ${currentDate.toLocaleDateString()}
Post-Op: ${displayDays} Days (${weeks} Weeks + ${remainderDays} Days)
Phase: ${activePhase.phaseName}

GOALS:
${activePhase.goals.map(g => `- ${g}`).join('\n')}

PRECAUTIONS:
${activePhase.precautions.map(p => `- ${p}`).join('\n')}

INTERVENTIONS:
${activePhase.interventions.map(i => `- ${i}`).join('\n')}
`;
    document.getElementById('generatedText').value = generatedText;
}

enterBtn.addEventListener('click', calculateProtocol);

// Copy to Clipboard
const copyBtn = document.getElementById('copyBtn');
const copyText = document.getElementById('copyText');

copyBtn.addEventListener('click', () => {
    const text = document.getElementById('generatedText').value;
    if (!text) return;

    navigator.clipboard.writeText(text).then(() => {
        const originalText = copyText.textContent;
        copyText.textContent = "Copied!";
        copyBtn.style.borderColor = "#22c55e";
        copyBtn.style.color = "#15803d";
        
        setTimeout(() => {
            copyText.textContent = originalText;
            copyBtn.style.borderColor = "#d1d5db";
            copyBtn.style.color = "#374151";
        }, 2000);
    });
});
</script>

</body>
</html>
